/**
 * Novalnet payment module
 *
 * This script is used for common utility functionality
 *
 * @author     Novalnet AG
 * @copyright  Copyright (c) Novalnet
 * @license    https://www.novalnet.de/payment-plugins/kostenlos/lizenz
 * @link       https://www.novalnet.de
 *
 * Script: novalnet.js
 */ 
function novalnet_load(){var e=getUrlVars();if(e.module&&e.action&&"edit"==e.action){var n=e.module.toUpperCase(),o=e.module;jQuery('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_BUTTON_HEIGHT]"]').on("keydown",function(e){if(8==e.keyCode||46==e.keyCode||16==e.keyCode||20==e.keyCode)return!0;if(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105){var o=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_BUTTON_HEIGHT]"]').val();if(""==o&&e.key>="3"&&e.key<="6"||o>=3&&o<=6&&(6==o&&(e.keyCode>=48&&e.keyCode<=52||e.keyCode>=96&&e.keyCode<=99)||o>=3&&o<6&&(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105)))return!0}return!1}),jQuery('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_APPLEPAY_BUTTON_CORNER_RADIUS]"]').on("keydown",function(e){var n=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_APPLEPAY_BUTTON_CORNER_RADIUS]"]').val();return 8==e.keyCode||46==e.keyCode||16==e.keyCode||20==e.keyCode||(""==n?!!(e.keyCode>=49)&&!!(e.keyCode<=57)||!!(e.keyCode>=97)&&!!(e.keyCode<=105):1==n&&(48==e.keyCode||96==e.keyCode))});var t=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_BUTTON_DISPLAY]"]');if("novalnet_applepay"==getUrlVars().module||"novalnet_googlepay"==getUrlVars().module){var i=JSON.parse(jQuery("#nn_googlepay_display").val()),a=JSON.parse(jQuery("#nn_applepay_display").val()),u={plain:i.plain,buy:i.buy,donate:i.donate,book:i.book,checkout:i.checkout,order:i.order,subscribe:i.subscribe,pay:i.pay},l=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_GOOGLEPAY_BUTTON_TYPE]"]'),r=l.val();jQuery(l).replaceWith('<select id="googlepay_button_type" name= "configuration[configuration/MODULE_PAYMENT_NOVALNET_GOOGLEPAY_BUTTON_TYPE]" ></select>'),appendOptions(u,r,"googlepay_button_type");var c={plain:a.plain,buy:a.buy,donate:a.donate,book:a.book,"check-out":a.checkout,order:a.order,subscribe:a.subscribe,pay:a.pay,contribute:a.contribute,tip:a.tip,rent:a.rent,reload:a.reload,support:a.support},l=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_APPLEPAY_BUTTON_TYPE]"]'),r=l.val();jQuery(l).replaceWith('<select id="applepay_button_type" name= "configuration[configuration/MODULE_PAYMENT_NOVALNET_APPLEPAY_BUTTON_TYPE]" ></select>'),appendOptions(c,r,"applepay_button_type");var p={black:a.dark,white:a.light,"white-outline":a.lightoutline},E=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_APPLEPAY_BUTTON_THEME]"]'),g=E.val();jQuery(E).replaceWith('<select id="applepay_button_theme" name= "configuration[configuration/MODULE_PAYMENT_NOVALNET_APPLEPAY_BUTTON_THEME]" ></select>'),appendOptions(p,g,"applepay_button_theme"),jQuery(t).replaceWith('<select id="nn_pages" name= "configuration[configuration/MODULE_PAYMENT_'+n+'_BUTTON_DISPLAY][]" multiple="multiple" style="width:50%;" ><option value="shopping cart page" selected="selected">'+i.cartpage+'</option> <option value="product page">'+i.productpage+'</option><option value="checkout page">'+i.checkoutpage+"</option></select>"),jQuery(t).replaceWith('<select id="nn_pages" name= "configuration[configuration/MODULE_PAYMENT_'+n+'_BUTTON_DISPLAY][]" multiple="multiple" style="width:50%;" ><option value="shopping cart page" selected="selected">'+a.cartpage+'</option> <option value="product page">'+a.productpage+'</option><option value="checkout page">'+a.checkoutpage+"</option></select>");var d=jQuery("#nn_button_display_page").val().split("|");jQuery(document).ready(function(){jQuery("#nn_pages").select2({closeOnSelect:!1,placeholder:"novalnet_googlepay"==getUrlVars().module?i.placeholder_text:a.placeholder_text,allowHtml:!0,allowClear:!0,tags:!0}),jQuery("#nn_pages").val(d).trigger("change")})}var T=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_CYCLE]"]');if("novalnet_instalment_sepa"==getUrlVars().module||"novalnet_instalment_invoice"==getUrlVars().module){jQuery(T).replaceWith('<select id="nn_cycles" name= "configuration[configuration/MODULE_PAYMENT_'+n+'_CYCLE][]" multiple="multiple" style="width:110%;" ><option value="2" selected="selected">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="15">15</option><option value="18">18</option><option value="21">21</option><option value="24">24</option><option value="36">36</option></select>');var d=jQuery("#"+getUrlVars().module+"_cycle").val().split("|");jQuery(document).ready(function(){jQuery("#nn_cycles").select2({closeOnSelect:!1,placeholder:"Instalment cycles",allowHtml:!0,allowClear:!0,tags:!0}),jQuery("#nn_cycles").val(d).trigger("change")})}if($('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_ENDCUSTOMER_INFO]"]').keyup(function(){this.value=this.value.replace(/<(.|\n)*?>/g,"")}),$('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_VISIBILITY_BY_AMOUNT]"]').keyup(function(){this.value=this.value.replace(/[^0-9]/g,"")}),$('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_MANUAL_CHECK_LIMIT]"]').keyup(function(){this.value=this.value.replace(/[^0-9]/g,"")}),checkDueDates(),"false"==$("#"+o+"_auth").val()&&$('input[name="configuration[configuration/MODULE_PAYMENT_'+n+"_MANUAL_CHECK_LIMIT]").hide(),"novalnet_cc"==getUrlVars().module||"novalnet_sepa"==getUrlVars().module){var N="";"EN"==jQuery("#lang_code").val()?N={"":"--Select--",authorize:"Authorize",capture:"Capture",zero_amount:"Authorize with zero amount"}:"DE"==jQuery("#lang_code").val()&&(N={"":"--W\xe4hlen Sie --",authorize:"Zahlung autorisieren",capture:"Zahlung einziehen",zero_amount:"Mit Nullbetrag autorisieren"});var A=jQuery('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_AUTHENTICATE]"]'),s=A.val();jQuery(A).replaceWith('<select id="payment_action" name= "configuration[configuration/MODULE_PAYMENT_'+n+'_AUTHENTICATE]" ></select>'),appendOptions(N,s,"payment_action");var f=$('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_MANUAL_CHECK_LIMIT]"');f.hide(),$("#payment_action").click(function(){"authorize"==$("#payment_action").find(":selected").val()?f.show():f.hide()})}else $('input:checkbox[name="configuration[configuration/MODULE_PAYMENT_'+n+'_AUTHENTICATE]"]').parent().click(function(){var e=$('input:checkbox[name="configuration[configuration/MODULE_PAYMENT_'+n+'_AUTHENTICATE]"]').parent(),o=$('input[name="configuration[configuration/MODULE_PAYMENT_'+n+'_MANUAL_CHECK_LIMIT]"');e[0].classList.contains("checked")?o.show():o.hide()});$('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_INSTALMENT_INVOICE_VISIBILITY_BY_AMOUNT]"]').blur(function(){1998>$(this).val()&&$(this).val("")}),$("input[name='configuration[configuration/MODULE_PAYMENT_NOVALNET_GUARANTEE_SEPA]']").parent().find("div").hide(),$("input[name='configuration[configuration/MODULE_PAYMENT_NOVALNET_GUARANTEE_SEPA]']").parents("div").first().hide(),$("input[name='configuration[configuration/MODULE_PAYMENT_NOVALNET_GUARANTEE_INVOICE]']").parent().find("div").hide(),$("input[name='configuration[configuration/MODULE_PAYMENT_NOVALNET_GUARANTEE_INVOICE]']").parents("div").first().hide(),$("input[name='configuration[configuration/MODULE_PAYMENT_NOVALNET_INSTALMENT_INVOICE_BASIC_REQ]']").parent().find("div").hide(),$("input[name='configuration[configuration/MODULE_PAYMENT_NOVALNET_INSTALMENT_INVOICE_BASIC_REQ]']").parents("div").first().hide(),$('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_INSTALMENT_SEPA_BASIC_REQ]').parent().find("div").hide(),$("input[name='configuration[configuration/MODULE_PAYMENT_NOVALNET_INSTALMENT_SEPA_BASIC_REQ]']").parents("div").first().hide()}}function checkDueDates(){$('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_INVOICE_DUE_DATE]"]').blur(function(){7>$(this).val()&&$(this).val("")}),$('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_PREPAYMENT_DUE_DATE]"]').blur(function(){(7>$(this).val()||$(this).val()>28)&&$(this).val("")}),$('input[name="configuration[configuration/MODULE_PAYMENT_NOVALNET_SEPA_DUE_DATE]"]').blur(function(){(2>$(this).val()||$(this).val()>14)&&$(this).val("")})}function appendOptions(e,n,o){0==$("#"+o+" > option").length&&jQuery.each(e,function(e,t){jQuery("#"+o).append(jQuery("<option>",{value:jQuery.trim(e),text:jQuery.trim(t)})),void 0!=n&&n==e&&jQuery("#"+o).val(e)})}function validateDateFormat(e){NovalnetUtility.validateDateFormat(e.value)||alert($("#nn_invoice_birthdate_error").val())}function getUrlVars(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(n,o,t){e[o]=t}),e}function validateNumericInput(e){e.value=e.value.replace(/[^0-9]/g,"")}function validateNumericInputmbway(e){e.value=e.value.replace(/[^0-9+]/g,"")}window.addEventListener?window.addEventListener("load",novalnet_load):window.attachEvent&&window.attachEvent("onload",novalnet_load);
