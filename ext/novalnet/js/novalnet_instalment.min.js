/**
 * Novalnet payment module
 *
 * This script is used for Instalment SEPA plan tables
 *
 * @author     Novalnet AG
 * @copyright  Copyright (c) Novalnet
 * @license    https://www.novalnet.de/payment-plugins/kostenlos/lizenz
 * @link       https://www.novalnet.de
 *
 * Script: novalnet_instalment_sepa.min.js
 */
function instalment_table(){var e="hidden"==$("input[name='payment']").attr("type")?$("input[name='payment']").val():$("input[name='payment']:checked").val();if("novalnet_instalment_sepa"==e)var n=$("#novalnet_global_recurring_period_cycles_sepa option:selected").val();else n=$("#novalnet_global_recurring_period_cycles_invoice option:selected").val();var t,a=$("#order_amount").val(),l=0,i=0;if("novalnet_instalment_sepa"==e){var o=jQuery("#nn_dob_placeholder").val();jQuery("#novalnet_instalment_sepa_dob").attr("placeholder",o)}else{o=$("#novalnet_instalment_invoicebirthdate").val();$("#novalnet_instalment_invoicebirthdate").attr("placeholder",o)}t=parseFloat(a).toFixed(2);for(var _=1;_<=n;_++)n!=_?(split_amount=parseFloat(t/n).toFixed(2),l=parseFloat(l)+parseFloat(split_amount)):i=parseFloat(t-l).toFixed(2);var r="",s=$("#nn_installmnet_currency").val(),d=n-1;"0"==n?$("#"+e+"_table thead tr").remove():($("#"+e+"_table thead tr").remove(),$("#"+e+"_table thead").append("<tr><th>"+jQuery("#nn_cycles_frontend").val()+"</th><th>"+jQuery("#nn_amount_frontend").val()+"</th></tr>")),$("#"+e+"_table").show(),$("#"+e+"_table tbody tr").remove();for(var m=0;m<n;m++){r=($("#nn_shop_lang").val(),m+1==1||m+1==21?m+1+"st "+jQuery("#nn_installment_frontend").val():m+1==2||m+1==22?m+1+"nd "+jQuery("#nn_installment_frontend").val():m+1==3?m+1+"rd "+jQuery("#nn_installment_frontend").val():m+1+"th "+jQuery("#nn_installment_frontend").val());var v=split_amount.toString().replace(/\./g,","),c=i.toString().replace(/\./g,",");d!=m?$("#"+e+"_table tbody").append("<tr><td>"+r+"</td><td>"+v+" "+s+"</td></tr>"):$("#"+e+"_table tbody").append("<tr><td>"+r+"</td><td>"+c+" "+s+"</td></tr>")}}function novalnet_instalment_sepa_load(){jQuery("input[name='payment']").val().toUpperCase();jQuery("form").each((function(){"checkout_payment"==jQuery(this).attr("id")&&(formid="checkout_payment")})),$(".mandate_confirm_instalment").hide(),$(".about_mandate_instalment").mouseover((function(){$(".mandate_confirm_instalment").show().next().toggle("slow")})),$(".about_mandate_instalment").mouseout((function(){$(".mandate_confirm_instalment").hide()})),jQuery("#"+formid).submit((function(e){if("novalnet_instalment_sepa"==("hidden"==jQuery("input[name='payment']").attr("type")?jQuery("input[name='payment']").val():jQuery("input[name='payment']:checked").val())&&(void 0!==jQuery("#novalnet_instalment_sepa_iban")&&""===NovalnetUtility.formatAlphaNumeric(jQuery("#novalnet_instalment_sepa_iban").val())))return!1})),jQuery("#novalnet_instalment_sepa_iban_field").keyup((function(e){if((jQuery(this).val(jQuery(this).val().toUpperCase()),void 0!==jQuery("#novalnet_instalment_sepa_iban_field"))&&""==NovalnetUtility.formatIban(jQuery("#novalnet_instalment_sepa_iban").val()))return!1})),jQuery("#novalnet_instalment_sepabirthdate").keydown((function(){NovalnetUtility.isNumericBirthdate(this,event)})),jQuery("#novalnet_instalment_sepa_new").click((function(){jQuery("#instalment_sepa_save_card").show(),jQuery("#instalment_iban").show(),jQuery("#novalnet_instalment_sepa_iban_field").show(),jQuery("#novalnet_instalment_sepa_iban_field").parents().eq(1).show(),jQuery("#novalnet_instalment_sepa_onclick").parents().eq(1).show()})),jQuery(".novalnet_instalment_sepa_saved_acc").click((function(){jQuery("#novalnet_instalment_sepa_iban_field").hide(),jQuery("#novalnet_instalment_sepa_iban").parents().eq(1).hide(),jQuery("#novalnet_instalment_sepa_onclick").parents().eq(1).hide(),jQuery("#instalment_iban").hide()})),$(".instalment_token").click((function(){var e={action:"delete_token",id:this.id};$.ajax({type:"POST",url:"novalnet_token_delete.php",data:e,success:function(e){location.reload()}})}))}function validateDateFormat(e){NovalnetUtility.validateDateFormat(e.value)||alert(jQuery("#nn_instalment_birthdate_error").val())}window.addEventListener?(window.addEventListener("DOMContentLoaded",instalment_table),window.addEventListener("change",instalment_table)):window.attachEvent&&(window.attachEvent("DOMContentLoaded",instalment_table),window.attachEvent("change",instalment_table)),document.addEventListener("DOMContentLoaded",(function(){$("input[name='payment']").click((function(){instalment_table()})),$("#novalnet_global_recurring_period_cycles_sepa option:selected").change((function(){instalment_table()})),$("#novalnet_global_recurring_period_cycles_invoice option:selected").change((function(){instalment_table()}))})),window.addEventListener?window.addEventListener("load",novalnet_instalment_sepa_load):window.attachEvent&&window.attachEvent("onload",novalnet_instalment_sepa_load);